SubDir PLASMA ;

if ! $(PLASMA_READY) {

C++FLAGS += -DTIXML_USE_STL ;

if SHARED in $(LIBRARIES) { 
  if PROFILE in $(VARIANTS) {
    Exit Cannot build PROFILE and SHARED ;
  }
  if CUSTOM in $(VARIANTS) && $(PROFILE) {
    Exit Cannot build PROFILE and SHARED ;
  }
}

Module plasma : all System ;

# 3rd party
SubInclude PLASMA TinyXml ;
SubInclude PLASMA Antlr ;

# kernel. order is important, it indicates dependencies
SubInclude PLASMA Utils ;
SubInclude PLASMA ConstraintEngine ;
SubInclude PLASMA PlanDatabase ;
SubInclude PLASMA RulesEngine ;
SubInclude PLASMA TemporalNetwork ;
SubInclude PLASMA NDDL ;
SubInclude PLASMA Solvers ;

# extensions
SubInclude PLASMA Resource ;
SubInclude PLASMA ANML ;

SubInclude PLASMA System ;
SubInclude PLASMA Examples ;

RemoveBinaries clean-all ;
Depends clean-all : clean clean-nddl-xml clean-system-xml ;

Depends build : build-modules ;

Depends run-tests : tests ;

Depends run-all-tests : 
    run-checkin-tests 
    run-all-module-tests  
    run-examples-tests 
    run-nddl-tests 
    run-hsts-planner-tests 
;

Depends run-checkin-tests : 
    check-svn-changes 
    run-tests 
    run-nddl-planner-tests 
    run-makefile-tests 
;

Depends run-makefile-tests : check-makefile ;

# install tests designed for off site customers to check system is installed without svn update
Depends run-install-tests : run-tests ;

NOCARE run-all-tests run-tests run-checkin-tests run-nddl-tests run-nddl-planner-tests tests run-hsts-planner-tests ;

Depends plasma-all : all ;

ExecuteScript check-svn-changes : bin/checksvn : $(PLASMA) ;

if ! ( "Resources" in $(NO) ) {
  ExecuteScript check-makefile : bin/checkmakeproject : $(PLASMA) ;
}

} # PLASMA_READY

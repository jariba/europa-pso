<?xml version="1.0"?>
<project name="timeline-view-test" default="test" basedir=".">
<target name="test" depends="totalbuild">
        <!-- PLANWORKS_ROOT is an inherited property from PlanWorks/build.xml -->
	<property name="arg_gcInit" value="192"/>
	<property name="arg_gcMax" value="975"/>
	<property name="eXist_conf_file" value="conf-nolog.xml"/>
	<property name="xml_files_dir" value="xml/test/monkey"/>
	<property name="EXIST_HOME" location="${PLANWORKS_ROOT}/java/lib/eXist"/>
	<property environment="env"/>
        <property name="junit.home" location="${env.JUNIT_HOME}"/>
        <property name="jfcunit.home" location="${env.JFCUNIT_HOME}"/>
        <property name="jakarta.regexp.home" location="${env.JAKARTA_REGEXP_HOME}"/>

	<path id="planworks.jars">
		<pathelement path="${PLANWORKS_ROOT}/java/classes"/>
		<pathelement location="${PLANWORKS_ROOT}/java/lib/JGo/JGo.jar"/>
		<pathelement location="${PLANWORKS_ROOT}/java/lib/JGo/JGoLayout.jar"/>
		<pathelement location="${PLANWORKS_ROOT}/java/lib/JGo/Classier.jar"/>
		<pathelement location="${env.JAVA_HOME}/lib/tools.jar"/>
                <pathelement location="${EXIST_HOME}/exist.jar"/>
                <fileset dir="${EXIST_HOME}/lib/core" includes="*.jar"/>
                <pathelement location="${junit.home}/junit.jar"/>
                <pathelement location="${jfcunit.home}/jfcunit.jar"/>
                <pathelement location="${jakarta.regexp.home}/jakarta-regexp-1.2.jar"/>
	</path>
	<delete>
		<fileset dir="${PLANWORKS_ROOT}/xml/db/data" includes="*.dbx"/>
		<fileset dir="${PLANWORKS_ROOT}/xml/db/logs" includes="*.log"/>
		<fileset dir="${PLANWORKS_ROOT}/xml/db/logs" includes="*.log*"/>
	</delete>

	<java dir="${PLANWORKS_ROOT}/java/src" 
                classname="gov.nasa.arc.planworks.viz.views.test.TimelineViewTest" fork="true">
            <classpath refid="planworks.jars"/>
            <!-- jvmarg value="-verbose:gc"/ -->
            <jvmarg value="-Xms${arg_gcInit}m"/>
            <jvmarg value="-Xmx${arg_gcMax}m"/>
            <jvmarg value="-Dplanworks.root=${PLANWORKS_ROOT}"/>
            <jvmarg value="-Duser=${env.USER}"/>
            <jvmarg value="-Dexist.initdb=true"/>
            <jvmarg value="-Dexist.home=${EXIST_HOME}"/>
            <jvmarg value="-Dexist.conf.xml=${eXist_conf_file}"/>
            <jvmarg value="-Dxml.files.dir=${PLANWORKS_ROOT}/${xml_files_dir}"/>
	</java>

</target>

<target name="totalbuild" description="conditionally build class files">
	<ant dir="${PLANWORKS_ROOT}/java"/>
</target>
</project>
<?xml version="1.0"?>
<!-- $Id: build.xml,v 1.8 2003-06-02 17:52:12 taylor Exp $ -->
<project name="PlanWorks" default="projectTest" basedir=".">
  <description>
    PlanWorks Build and Run Targets
  </description>

  <property name="planworks.root" value="${basedir}"/>

  <target name="existTest"  depends="check_jvm_2, cleanDb"
    description="-- prototyping test (compile dependency)">
    <ant dir="./test" antfile="exist-test.xml"/>
  </target>

  <target name="projectTest" depends="check_jvm_2" 
      description="-- prototyping test (compile dependency)">
    <ant dir="./test" antfile="project-test.xml"/>
  </target>

  <target name="timelineViewTest" depends="check_jvm_2, cleanDb" 
      description="-- JFCunit test (compile dependency)">
    <ant dir="./java/src/gov/nasa/arc/planworks/viz/views/test" 
       antfile="timeline-view-test.xml"/>
  </target>

  <target name="cleanCls" depends="check_jvm_2"
      description="-- delete the 'java/classes' directory tree">
    <ant dir="./java" antfile="build.xml" target="clean"/>
  </target>

  <target name="compile" depends="check_jvm_2"
      description="-- compile 'java/src' tree into 'java/classes' tree">
    <ant dir="./java" antfile="build.xml" target="compile"/>
  </target>

  <target name="cleanDb" description="-- delete loaded projects from data base">
    <delete>
      <fileset dir="${planworks.root}/xml/db/data" includes="*.dbx"/>
      <fileset dir="${planworks.root}/xml/db/logs" includes="*.log"/>
      <fileset dir="${planworks.root}/xml/db/logs" includes="*.log*"/>
      <fileset dir="${planworks.root}/xml/db/proj" includes="*.xml"/>
    </delete>
  </target>

  <!-- JVM checking from Tarang Patel -->

  <target name="check_jvm_1">
    <available property="jdk1.4+" classname="java.lang.CharSequence" />
    <condition property="correct.java">
      <equals arg1="${jdk1.4+}" arg2="true"/>
    </condition>
    <echo message="ant.java.version ${ant.java.version}"/>
  </target>

  <target name="check_jvm_2" depends="check_jvm_1" unless="correct.java">
    <fail message="Wrong JVM version: ${ant.java.version} => require jdk1.4.*"/>
  </target>

</project>